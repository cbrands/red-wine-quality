Exploratory data analysis of red wine by Charles Brands
========================================================

> **Tip**: You will see quoted sections like this throughout the template to
help you construct your report. Make sure that you remove these notes before
you finish and submit your project!


```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
#Loading the needed libraries

library(gridExtra)
library(ggplot2)
library(ggthemes)
library(pander)
library(Hmisc)
#library(dplyr)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
wine <- read.csv("wineQualityReds.csv")
# Column X is basically the row number, remove it
wine$X <- NULL
head(wine)
```

```{r echo=FALSE, Show_summary}
str(wine)

# Lets look at quality
summary(wine$quality)
table(wine$quality)
```

In this analysis we look into the effect of different chemical properties on the wine quality. This dataset has 12 variabeles, the quality and 11 chemical properties of the wine (fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlorides, free.sulfur.dioxide, total.sulfur.dioxide, density, pH, sulphates, and alcohol).
This dataset has 1599 observations.

# Univariate Plots Section

```{r echo=FALSE, Univariate_Plots_quality}
theme_set(theme_economist())
qplot(wine$quality, bins = 30)
```
```{r echo=FALSE, Univariate_Plots_Quality_summary}
summary(wine$quality)
```

The quality of the wines run from 3 to 8 with most of the wines are either a 5 or a 6. The quality is a discrete value. The mean is 5.6.

```{r echo=FALSE, Univariate_Plots_fixed_acidity}

geometry <- geom_histogram(bins = 30, color = 'black', fill = '#5760AB')

uni_plot <- function(plotvar, plot_label) {
  grid.arrange(
    ggplot(data = wine, aes(x=plotvar)) + geometry + labs(x = plot_label), 
    ggplot(wine, aes( x = 1, y = plotvar ) ) + 
      geom_jitter(alpha = 0.6 ) +
      geom_boxplot(alpha = 0.2, color = 'orange', size = 1) + 
      stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
      labs(y = plot_label)
  ,ncol = 2)
}

uni_plot(plotvar=wine$fixed.acidity, plot_label="Fixed acidity (g/dm^3)")
```
```{r echo=FALSE, Univariate_Plots_Fixed_acidity_summary}
summary(wine$fixed.acidity)
```

The fixed acidity is a right tailed distribution. The median is at 7.9 g/dm^3. Due to the outliers on the right the mean is pulled to 8.3 g/dm^3.

```{r echo=FALSE, Univariate_Plots}
uni_plot(plotvar=wine$volatile.acidity, plot_label="Volatile acidity (g/dm^3)")
```
```{r echo=FALSE, Univariate_Plots}
summary(wine$volatile.acidity)
```

The volatile acidity is a normal distribution with a few outliers to the right. The mean and median are pretty close together at 0.5200 and 0.5278 g/dm^3 respectively.

```{r echo=FALSE, Univariate_Plots}
uni_plot(plotvar=wine$citric.acid, plot_label="Citric acid (g/dm^3)")
```
```{r echo=FALSE, Univariate_Plots}
summary(wine$citric.acid)
```

The citric acid distribution is weird. It looks like two right skewed distribution on top of oneother.

```{r echo=FALSE, Univariate_Plots}
uni_plot(plotvar=wine$residual.sugar, plot_label="Residual sugar (g/dm^3)")
```
```{r echo=FALSE, Univariate_Plots}
summary(wine$residual.sugar)
```

The residual sugar distribution has a sharp peak at around 2.2 g/dm^3. Although the tail is long the peak is so far above the rest that the mean is only pulled a little bit to the right of the median. The boxplot is also rather flat as the amount of wines with a residual sugar around 2.2 is huge compared to the rest.

```{r echo=FALSE, Univariate_Plots}
uni_plot(plotvar=wine$chlorides, plot_label="Chlorides (g/dm^3)")
```
```{r echo=FALSE, Univariate_Plots}
summary(wine$chlorides)
```

The chlorides distribution is also sharply peaked. This time the peak is around 0.079 g/dm^3. 

```{r echo=FALSE, Univariate_Plots}
uni_plot(plotvar=wine$free.sulfur.dioxide, plot_label="Free sulfur dioxide (mg/dm^3)")
```
```{r echo=FALSE, Univariate_Plots}
summary(wine$free.sulfur.dioxide)
```

The free sulfur distribution has a tail on the right. The median and mean are 14.00 and 15.87 mg/dm^3 respectively.

```{r echo=FALSE, Univariate_Plots}
uni_plot(plotvar=wine$total.sulfur.dioxide, plot_label="Total sulfur dioxide (mg/dm^3)")
```
```{r echo=FALSE, Univariate_Plots}
summary(wine$total.sulfur.dioxide)
```

The total sulur distribution is a right tailed distribution with some outlier very far to the right. The median and the mean are 38.00 and 46.47 mg/dm^3 respectively with a max at 289 mg/dm^3!

```{r echo=FALSE, Univariate_Plots}
uni_plot(plotvar=wine$density, plot_label="Density (g/cm^3)")
```
```{r echo=FALSE, Univariate_Plots}
summary(wine$density)
```

The density is a normal distributin with a mean of 0.9967 g/cm^3.

```{r echo=FALSE, Univariate_Plots}
uni_plot(plotvar=wine$pH, plot_label="pH")
```
```{r echo=FALSE, Univariate_Plots}
summary(wine$pH)
```

The ph distribution is a normal distribution with a mean at 3.311

```{r echo=FALSE, Univariate_Plots}
uni_plot(plotvar=wine$sulphates, plot_label="Sulphates (g/dm^3)")
```
```{r echo=FALSE, Univariate_Plots}
summary(wine$sulphates)
```

The sulfates distribution is a right skewed distributionwith some outliers far to the right. 

```{r echo=FALSE, Univariate_Plots}
uni_plot(plotvar=wine$alcohol, plot_label="Alcohol (%)")
```

```{r echo=FALSE, Univariate_Plots}
summary(wine$alcohol)
```

The alcohol percentage distribution is right skewd with a median of 10.20% and a mean of 10.42%.

# Univariate Analysis

### What is the structure of your dataset?
The red wine dataset had originally 1599 rows and 13 columns. I deleted the column X as it basically is the same as the rownumber. So I had 12 columns left. The columns are the quality and 11 chemical properties of the wine ( fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlorides, free.sulfur.dioxide, total.sulfur.dioxide, density, pH, sulphates, alcohol, and quality). The quality is a discrete with values: 4, 5, 6, 7, and 8 the rest is continuous.

### What is/are the main feature(s) of interest in your dataset?
The most important feature of the dataset is quality. I am interested how the quality is affected by the other properties of the wine. 

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?
At this point we have not yet analized the data. As I don't drink alcohol and have never tasted wine I am guessing here. As people in general seem to like sugar and alcohol I would expect that those properties have a positive impact on the quality. I would expect sulfur, sulfates and chlorides to have a negative effect.

### Did you create any new variables from existing variables in the dataset?
No. I did delete the column X as the sample number ad the rowcount are the same.

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?
The citric acid distribution is very unusual. It looks like two right skewed distribution on top of oneother. Other than removing the column X as described above I did not change the data.

# Bivariate Plots Section

I am interested in the chemical properties that have an effect on the quality of the wine. I intend to plot the quality with all the available properties but first let us make a correlation table to get a first idea of which properties have the strongest effect on the quality of the wine.

```{r echo=FALSE, Bivariate_Plots}
cor_test <- function(x, y) {
  return(cor.test(x, as.numeric(y))$estimate)
}

cor_test_with_quality <- function(x) {
  return(cor_test(x, wine$quality))
}

corTable <- c(
  cor_test_with_quality(wine$fixed.acidity),
  cor_test_with_quality(wine$volatile.acidity),
  cor_test_with_quality(wine$citric.acid),
  cor_test_with_quality(wine$residual.sugar),
  cor_test_with_quality(wine$chlorides),
  cor_test_with_quality(wine$free.sulfur.dioxide),
  cor_test_with_quality(wine$total.sulfur.dioxide),
  cor_test_with_quality(wine$density),
  cor_test_with_quality(wine$pH),
  cor_test_with_quality(wine$sulphates),
  cor_test_with_quality(wine$alcohol))
names(corTable) <- c('fixed.acidity', 'volatile.acidity', 'citric.acid',
                         'residual.sugar', 'chlorides', 'free.sulfur.dioxide',
                         'total.sulfur.dioxide', 'density', 'pH',
                         'sulphates', 'alcohol')
print("Correlation of wine quality with different properties")
corTable
```

We see that alcohol, sulphates, citric acidity, and fixed acidity have a positive correlation with the wine quality. Volatile acidity, chlorides, total sulfur dioxide, and density have a negative correlation. The rest doesn't seem to do much.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality <- function(xplot, label) {
  ggplot(aes(x=factor(wine$quality), y=xplot), data = wine) +
    geom_point() + 
    labs(x = "quality", y = label) + 
    geom_jitter( alpha = .3) + 
    geom_boxplot(fill="pink", color="red", alpha=0.3)  +
    coord_flip() + 
    stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4)
}
```

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$fixed.acidity, "Fixed acidity (g/dm^3)")
```

In this plot we see that fixed acidity has almost no effect on the wine quality.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$volatile.acidity, "Volatile acidity (g/dm^3)")
```

This plot clearly shows that increasing the volitile acidity degrades the wine quality.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$citric.acid, "Citric acid (g/dm^3)")
```

Increasing the citric acidity increases the quality of the wine.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$residual.sugar, "Residual sugar (g/dm^3)")
```

Residual sugar seems to have no effect on the wine quality. 

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$chlorides, "Chlorides (g/dm^3)")
```

Chlorides have a negative impact on the wine quality.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$free.sulfur.dioxide, "Free sulfur dioxide (mg/dm^3)")
```

Free sulfur dioxide is mostly present in the wines of average quality. Both the good wines as the terrible wines have a lower free sulfur dioxide concentration.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$total.sulfur.dioxide, "Total sulfur dioxide (mg/dm^3)")
```

Total sulfur dioxide is mostly present in the wines of average quality. Both the good wines as the terrible wines have a lower total sulfur dioxide concentration.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$density, "Density (g/cm^3)")
```

Increasing the density loweres the quality of the wine.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$pH, "pH")
```

Lowering the pH has a positive impact on the quality of the wine. 

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$sulphates, "Sulphates (g/dm^3)")
```

Increasing sulphates concentration increases the quality of the wine.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_quality(wine$alcohol, "Alcohol (%)")
```

Increasing the alcohol concentration increases the wine quality.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_simple <- function(xplot, yplot, xlabel, ylabel) {
  ggplot(aes(x=xplot, y=yplot), data = wine) +
    geom_point() + 
    labs(x = xlabel, y = ylabel) 
}

biv_scat_plot_simple(wine$alcohol, wine$density, "Alcohol (%)", "Density (g/cm^3)")
```

We can see that increasing the alcohol percentage loweres the density. This is not surpricing as alcohol has a lower density than water. This can explain the increase in wine quality as the density is lowered. The other properties that had an effect on wine quality did not have a clear relation with alcohol percentage.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_simple(wine$pH, wine$citric.acid, "pH", "Citric acid (g/dm^3)")
```

We see that increasing the citric acidity concentration loweres the pH value. Not surpricing.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_simple(wine$pH, wine$fixed.acidity, "pH", "Fixed acidity (g/dm^3)")
```

Increasing the fixed acidity lowers the pH. 

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_simple(wine$pH, wine$volatile.acidity, "pH", "Volatile acidity (g/dm^3)")
```

Volatile acidity has not much effect on the pH.

```{r echo=FALSE, Bivariate_Plots}
biv_scat_plot_simple(wine$total.sulfur.dioxide, wine$free.sulfur.dioxide, "Total sulfur dioxide (mg/dm^3)", "Free sulfur dioxide (mg/dm^3)")
```

```{r echo=FALSE, Bivariate_Plots}
cor_test(wine$total.sulfur.dioxide, wine$free.sulfur.dioxide)
```

The correlation between total sulfur dioxide and free sulfur dioxide is 0.668 the strongest I found in this dataset.

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?
The strongest positive correlation with quality is the alcohol percentage. Further sulphates and citric acidity had positive effects on the wine quality. The wine quality was negatively influenced by volatile aidity, chlorides, and density. The influence of density could be explained by the negative correlation with alcohol. 
Contrary to my expectation residual sugar levels had little to no effect on the wine quality.

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?
Fixed acidity and citric acidity had a strong negative effect on the pH while volatile acidity had no effect on the pH. Yet Fixed acidity had no effect on the quality of the wine. So apparently the quality of the wine is not determined by the acidity of the wine but is more influenced by the precence of citric acid which has a positive effect on quality and volatile acidity which has a negative effect.

### What was the strongest relationship you found?
The relation between total sulfur dioxide and free sulfur dioxide was the strongest relation found with a correlation coefficient of 0,668.

# Multivariate Plots Section

> **Tip**: Now it's time to put everything together. Based on what you found in
the bivariate plots section, create a few multivariate plots to investigate
more complex interactions between variables. Make sure that the plots that you
create here are justified by the plots you explored in the previous section. If
you plan on creating any mathematical models, this is the section where you
will do that.

```{r echo=FALSE, Multivariate_Plots}
multi_plot <- function(x, y, z, alpha, size, xlabel, ylabel, zlabel) {
  breaks = c("3", "4", "5", "6", "7", "8")
  labels = c("3", "4", "5", "6", "7", "8")
  color_values = c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")
  ggplot(data = wine,aes(x = x, y = y, alpha = alpha)) +
    geom_point(alpha = alpha, size = size, aes(color = factor(z))) +
    xlab(xlabel) +
  ylab(ylabel) + 
  scale_color_manual(breaks = breaks,
                      labels = labels,
                      values = color_values) +
  scale_fill_manual(breaks = breaks,
                      labels = labels,
                      values = color_values)
}
```

```{r echo=FALSE, Multivariate_Plots}
multi_plot(x=wine$alcohol,y=wine$density, z=wine$quality, 
           alpha = 0.8, size=0.8,
           xlabel="Alcohol (%)", ylabel="Density (g/cm^3)",
           zlabel="Quality level")
```

```{r echo=FALSE, Multivariate_Plots}
multi_qplot <- function(x, y, z, alpha=0.4) {
  qplot(x, y, data=wine, color=z) +
    geom_point(position=position_jitter(w = 0.025, h = 0.025), alpha=alpha) +
    guides(alpha=FALSE)
}
multi_qplot(wine$density, wine$volatile.acidity, wine$quality) +
  xlab("Density (g/cm^3)") +
  ylab("Volatile acidity (g/cm^3)") +
  labs(color="Quality level")
```

```{r echo=FALSE, Multivariate_Plots}

```


# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the \
strengths and limitations of your model.

------

# Final Plots and Summary

> **Tip**: You've done a lot of exploration and have built up an understanding
of the structure of and relationships between the variables in your dataset.
Here, you will select three plots from all of your previous exploration to
present here as a summary of some of your most interesting findings. Make sure
that you have refined your selected plots for good titling, axis labels (with
units), and good aesthetic choices (e.g. color, transparency). After each plot,
make sure you justify why you chose each plot by describing what it shows.

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection

> **Tip**: Here's the final step! Reflect on the exploration you performed and
the insights you found. What were some of the struggles that you went through?
What went well? What was surprising? Make sure you include an insight into
future work that could be done with the dataset.

> **Tip**: Don't forget to remove this, and the other **Tip** sections before
saving your final work and knitting the final report!